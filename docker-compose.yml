version: "3.8"

services:
  research-tool:
    build: .
    container_name: research-tool
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      # SearXNG Configuration (your local instance)
      RESEARCH_SEARXNG_HOST: "http://192.168.1.3:8888"
      RESEARCH_SEARXNG_ENGINES: "google,bing,duckduckgo,brave,startpage"
      RESEARCH_SEARXNG_CATEGORIES: "general"
      RESEARCH_SEARXNG_LANGUAGE: "en"
      RESEARCH_SEARXNG_SAFESEARCH: "0"

      # Tavily Configuration (optional - leave empty to disable)
      RESEARCH_TAVILY_API_KEY: "${TAVILY_API_KEY:-}"
      RESEARCH_TAVILY_SEARCH_DEPTH: "advanced"

      # LinkUp Configuration (optional - leave empty to disable)
      RESEARCH_LINKUP_API_KEY: "${LINKUP_API_KEY:-}"
      RESEARCH_LINKUP_DEPTH: "standard"

      # Tongyi/LLM Configuration (connects to llama.cpp on host)
      RESEARCH_LLM_API_BASE: "http://172.17.0.1:8080/v1"
      RESEARCH_LLM_API_KEY: "not-needed"
      RESEARCH_LLM_MODEL: "tongyi-deepresearch-30b"
      RESEARCH_LLM_TEMPERATURE: "0.85"
      RESEARCH_LLM_TOP_P: "0.95"
      RESEARCH_LLM_MAX_TOKENS: "8192"

      # Search Configuration
      RESEARCH_DEFAULT_TOP_K: "10"
      RESEARCH_RRF_K: "60"
    networks:
      - research-net
    extra_hosts:
      - "host.docker.internal:host-gateway"

networks:
  research-net:
    driver: bridge
